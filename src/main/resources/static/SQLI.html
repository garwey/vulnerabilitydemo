<!DOCTYPE html>
<html lang="en">
<script src="https://cdn.staticfile.org/jquery/3.3.1/jquery.min.js"></script>
<head>
    <meta charset="UTF-8">
    <title>sql injection test</title>
</head>
<body>
<button type="button" onclick="request_data('user/getAll')">显示所有数据</button>
<p/>
根据id获取(可SQL注入)
<input type="text" id="id1"/>
<button type="button" onclick="request_data('user/findone')">提交</button>
<p/>
根据username获取
<input type="text" id="username1"/>
<button type="button" onclick="request_data('user/getByUsername')">提交</button>
<p/>
创建用户<br/>
username<input type="text" id="username2"/><br/>
password<input type="text" id="password2"/><br/>
name<input type="text" id="name2"/><br/>
<button type="button" onclick="request_data('user/create')">提交</button>
<p/>
<h2>可SQL注入</h2>
根据id获取
<input type="text" id="id2"/>
<button type="button" onclick="request_data('user')">提交</button>
<p/>
根据id和username获取
<input type="text" id="id3"/>
<input type="text" id="username3"/>
<button type="button" onclick="request_data('user/getByIdUsername')">提交</button>
<p/>
<table class="table" border="1" cellspacing="0" cellpadding="10"></table>
<script>
    function request_data(url) {
        if (url == 'user/findone') {
            var id = document.getElementById("id1").value;
            url += '?id=' + id;
        } else if (url == 'user/getByUsername') {
            id = document.getElementById("username1").value;
            url += '?username=' + id;
        } else if (url == 'user/create') {
            var username = document.getElementById("username2").value;
            var password = document.getElementById("password2").value;
            var name = document.getElementById("name2").value;
            url += '?username=' + username + "&password=" + password + "&name=" + name;
        } else if (url == 'user/getByIdUsername') {
            id = document.getElementById("id3").value;
            username = document.getElementById("username3").value;
            url += '?id=' + id + "&username=" + username;
        } else if (url == 'user') {
            id = document.getElementById("id2").value;
            url += '?id=' + id;
        }
        $.ajax({
            type: "get",
            url: url,
            async: true,
            success: function (res) {
                render_table(res)
            }, error: function () {
                alert("No data")
            }
        });
    }

    function render_table(res) {
        if (res == "") alert("No data");
        let data = eval(res);
        let len = data.length;
        let form_data = "<tr>\n" +
            "        <th>id</th>\n" +
            "        <th>username</th>\n" +
            "        <th>password</th>\n" +
            "        <th>name</th>\n" +
            "        <th>description</th>\n" +
            "    </tr>";
        if (typeof (len) == 'undefined') {
            form_data += '<tr data-id=0>';
            form_data += '<td>' + data['id'] + '</td>';
            form_data += '<td>' + data['username'] + '</td>';
            form_data += '<td>' + data['password'] + '</td>';
            form_data += '<td>' + data['name'] + '</td>';
            form_data += '<td>' + data['description'] + '</td>';
            form_data += '</tr>';
        } else {
            for (let i = 0; i < len; i++) {
                form_data += '<tr data-id=' + (i + 1) + '>';
                form_data += '<td>' + data[i]['id'] + '</td>';
                form_data += '<td>' + data[i]['username'] + '</td>';
                form_data += '<td>' + data[i]['password'] + '</td>';
                form_data += '<td>' + data[i]['name'] + '</td>';
                form_data += '<td>' + data[i]['description'] + '</td>';
                form_data += '</tr>';
            }
        }
        $('.table').html(form_data);
    }
</script>
</body>
</html>